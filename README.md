# Telegram Bot для сбора ежедневных отчетов

Этот бот позволяет администраторам отправлять ежедневные отчеты о проделанной работе с горничными, подсобными рабочими, доплатами за проживание и поломками.

## Функциональность

- Регистрация администраторов
- Сбор ежедневных отчетов:
  - Кто работал из горничных
  - Кто работал из подсобных рабочих
  - Сколько и по каким объектам собраны доплаты за проживание
  - Поломки и неисправности
  - Готовность объекта к сдаче (да/нет)
- Автоматические напоминания в 15:00 по Московскому времени
- Ежедневная сводка для владельца в 18:00 по Московскому времени
- Управление списком объектов

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd tg_report_bot
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте файл `.env` и укажите следующие переменные:
```env
BOT_TOKEN=ВАШ_ТОКЕН_БОТА
MONGODB_URI=ВАШ_MONGODB_URI
OWNER_ID=ВАШ_TELEGRAM_ID
```

4. Запустите скрипт для заполнения списка объектов:
```bash
npm run populate
```

5. Запустите бота:
```bash
npm start
```

## Использование

### Для администраторов:

1. Найдите бота в Telegram и отправьте команду `/start` для регистрации
2. Используйте команду `/report` для отправки ежедневного отчета
3. Используйте команду `/today` для просмотра сегодняшних отчетов
4. Используйте команду `/objects` для управления объектами

### Для владельца:

1. Убедитесь, что ваш Telegram ID указан в переменной `OWNER_ID`
2. Бот будет автоматически отправлять сводку в 18:00 по Московскому времени

## Команды

- `/start` - регистрация нового администратора
- `/help` - показать список команд
- `/report` - отправить ежедневный отчет
- `/today` - посмотреть сегодняшние отчеты
- `/objects` - управление объектами
- `/add_object [адрес]` - добавить новый объект
- `/list_objects` - список всех объектов

## Структура проекта

- `index.js` - основной файл запуска бота
- `bot.js` - инициализация бота
- `commands.js` - обработка команд
- `reminders.js` - настройка напоминаний
- `reportUtils.js` - утилиты для генерации отчетов
- `db/connectDB.js` - подключение к базе данных
- `models/` - модели MongoDB
  - `Admin.js` - модель администратора
  - `Object.js` - модель объекта
  - `Report.js` - модель отчета

## Требования

- Node.js >= 20.19.0
- MongoDB (локальная или облачная)
- Telegram Bot Token (получить у @BotFather)

## Настройка объектов

По умолчанию в систему добавлены следующие объекты:
- Рябиновая 45 (Ветви)
- Рябиновая 57 (Марина)
- Рябиновая 90 (Тимур)
- Рябиновая 49 (Женя)
- Рябиновая 146/1 (Гарик)
- Славянская 1 (Сергей и Максим)
- Славянская 183 (Алиса)
- Славянская 86 (Яна)
- Тайга скай
- Шахтеров 26 (Оля)
- Шахтеров 138 (Екатерина)
- Ягодная 25 (Радик)
- Строителей, Грозовая (Елена)
- Хвойная, 37 (Алексей)
- Рябиновая, 113 (Владислав)

Вы можете добавлять новые объекты с помощью команды `/add_object`.